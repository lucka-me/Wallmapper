(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{14:function(e,t,i){"use strict";i.d(t,"a",(function(){return ie}));var a,s=i(1),n=i(6),l=i(24);function c(e,t,i){const a=document.createElement(e);for(const[e,i]of Object.entries(t))switch(e){case"cssText":a.style.cssText=i;break;case"dataset":for(const[e,t]of Object.entries(i))a.dataset[e]=t;break;default:a[e]=i}return i&&a.append(...i),a}!function(e){e.Prototype=class{constructor(){this.parent=null,Object.defineProperty(this,"parent",{enumerable:!1})}init(e){this.parent=e}render(){}}}(a||(a={})),function(e){e.copy=function(t){const i=e("textarea",{value:t,readOnly:!0});document.body.append(i),i.select(),document.execCommand("copy"),i.remove()}}(c||(c={}));const r={appBar:"mdc-top-app-bar mdc-top-app-bar--fixed",row:"mdc-top-app-bar__row",sectionStart:["mdc-top-app-bar__section","mdc-top-app-bar__section--align-start"].join(" "),sectionEnd:["mdc-top-app-bar__section","mdc-top-app-bar__section--align-end"].join(" "),title:"mdc-top-app-bar__title",fixedAdjust:"mdc-top-app-bar--fixed-adjust"};function o(e,t){return c("header",{className:r.appBar},[c("div",{className:r.row},[c("section",{className:r.sectionStart},[c("span",{className:r.title,innerHTML:e})]),c("section",{className:r.sectionEnd,role:"toolbar"},t)])])}(o||(o={})).fixedAdjust=function(){return c("div",{className:r.fixedAdjust})};const d="mdc-button mdc-button--outlined",m="mdc-button__ripple",p="mdc-button__label";function h(e){return c("button",{className:d},[c("div",{className:m}),c("span",{className:p,innerHTML:e})])}function u(e){return c("i",{className:"fa fa-fw",innerHTML:e})}!function(e){e.Icon={search:"",thList:"",times:"",cog:"",clock:"",camera:"",edit:"",infoCircle:"",arrowUp:"",plus:"",calendarAlt:"",folderOpen:"",globe:"",angleUp:"",angleDown:"",ellipsisV:"",trash:"",userCircle:"",syncAlt:"",redoAlt:"",mapMarkerAlt:"",tachometerAlt:"",brain:""}}(u||(u={}));var b=i(23);const g="mdc-menu-surface--anchor",f="mdc-menu mdc-menu-surface",v="mdc-list",w="mdc-list-item",y="mdc-list-item__ripple",x="mdc-list-item__text";function N(e){return c("div",{className:g},[c("div",{className:f},[c("ul",{className:v,role:"menu",ariaHidden:!0,ariaOrientation:"vertical"},e)])])}(N||(N={})).item=function(e,t){return c("li",{className:w,role:"menuitem",dataset:{code:e}},[c("span",{className:y}),c("span",{className:x,innerHTML:t})])};class _ extends a.Prototype{constructor(){super(...arguments),this.ctrl=null,this.events={selectStyle:()=>{}}}render(){const e=N(s.a.style.styles.map(((e,t)=>N.item(""+t,e.title))));this.parent.append(e),this.ctrl=new b.a(e.querySelector(".mdc-menu")),this.ctrl.listen("MDCMenu:selected",(e=>{const t=e.detail.item;this.events.selectStyle(parseInt(t.dataset.code),t.querySelector(".mdc-list-item__text").innerHTML)}))}open(){this.ctrl||this.render(),this.ctrl.open||(this.ctrl.open=!0)}}class L extends a.Prototype{constructor(){super(...arguments),this.menu=new _,this.actionPanel=null,this.actionMenu=null,this.events={openPanel:()=>{},selectStyle:()=>{}}}init(e){super.init(e),this.render()}render(){const e=(t=u.Icon.cog,c("button",{className:"fa mdc-icon-button",title:"Preference"||"",innerHTML:t}));var t;const i=h(s.a.style.selectedStyle.title),a=o("Mapler",[e,i]);this.parent.append(a),this.menu.init(a.querySelector(".mdc-top-app-bar__section--align-end")),this.menu.events.selectStyle=(e,t)=>{i.querySelector("span").innerHTML=t,this.events.selectStyle(e)},this.actionPanel=new n.a(e),this.actionPanel.unbounded=!0,this.actionPanel.listen("click",(()=>this.events.openPanel())),this.actionMenu=new n.a(i),this.actionMenu.listen("click",(()=>this.menu.open())),this.parent.append(o.fixedAdjust()),new l.a(a)}enable(){this.actionPanel.disabled=!1,this.actionMenu.disabled=!1}disable(){this.actionPanel.disabled=!0,this.actionMenu.disabled=!0}}var z=i(8),M=i.n(z);i(16);class T extends a.Prototype{constructor(){super(...arguments),this.root=null,this.ctrl=null,this.config={camera:{lon:0,lat:0,zoom:0,bearing:0,tilt:0},style:"",displayLabels:!0},this.events={idle:()=>{}}}init(e){super.init(e),M.a.accessToken="pk.eyJ1IjoibHVja2EtbWUiLCJhIjoiY2poa2xyN3J4MGJ0bTM3bjV5bjdvNDh3ZSJ9.QztckHrHyEuKp5_pVXmpIw",this.render()}render(){this.root=c("div",{className:"map"}),this.parent.append(this.root),this.ctrl=new M.a.Map({container:this.root,style:this.config.style,center:[this.config.camera.lon,this.config.camera.lat],zoom:this.config.camera.zoom,bearing:this.config.camera.bearing,pitch:this.config.camera.tilt,preserveDrawingBuffer:!0}),this.ctrl.once("load",(()=>{this.config.displayLabels||(this.diaplayLabels=!1),this.ctrl.resize()})),this.ctrl.on("idle",(()=>this.onIdle())),this.ctrl.addControl(new M.a.NavigationControl),this.ctrl.addControl(new M.a.GeolocateControl({positionOptions:{enableHighAccuracy:!0},showUserLocation:!1}))}onIdle(){const e=this.ctrl.getCenter();this.events.idle({lon:e.lng,lat:e.lat,zoom:this.ctrl.getZoom(),bearing:this.ctrl.getBearing(),tilt:this.ctrl.getPitch()})}set defaults(e){this.config=e}set diaplayLabels(e){this.config.displayLabels=e,this.ctrl.getStyle().layers.forEach((t=>{"symbol"===t.type&&this.ctrl.setLayoutProperty(t.id,"visibility",e?"visible":"none")}))}set style(e){this.ctrl.setStyle(e),this.config.displayLabels||this.ctrl.once("styledata",(()=>this.diaplayLabels=!1))}set camera(e){this.ctrl.flyTo({center:[e.lon,e.lat],zoom:e.zoom,bearing:e.bearing,pitch:e.tilt})}shot(e,t){const i=c("img",{className:"cover",src:this.ctrl.getCanvas().toDataURL()});this.parent.append(i);const a=this.ctrl.getBounds();this.root.classList.add("producing"),this.root.style.width=e.width/e.pixelRatio+"px",this.root.style.height=e.height/e.pixelRatio+"px",this.ctrl.resize(),this.ctrl.fitBounds(a),this.ctrl.once("idle",(()=>{const e=c("a",{href:this.ctrl.getCanvas().toDataURL(),download:"Mapler.png",cssText:"display:none"});this.parent.append(e),e.click(),this.parent.removeChild(e),this.root.classList.remove("producing"),this.root.style.cssText="",this.ctrl.resize(),this.ctrl.fitBounds(a),this.parent.removeChild(i),t()}))}}var k=i(25),H=i(26),P=i(22);const R="mdc-dialog",C="mdc-dialog__container",S="mdc-dialog__surface",j="mdc-dialog__content",q="mdc-dialog__title",I="mdc-dialog__actions",A="mdc-dialog__scrim",F="mdc-button mdc-dialog__button",B="mdc-button__ripple",D="mdc-button__label";function O(e,t){const i=[];return t.title&&i.push(c("h2",{className:q,innerHTML:t.title})),i.push(c("div",{className:j},t.contents)),t.actions&&i.push(c("footer",{className:I},t.actions.map((e=>c("button",{className:F,dataset:{mdcDialogAction:e.action}},[c("div",{className:B}),c("span",{className:D,innerHTML:e.text})]))))),c("div",{className:`${R} ${e}`,role:"dialog",ariaModal:!0},[c("div",{className:C},[c("div",{className:S},i)]),c("div",{className:A})])}(O||(O={})).link=function(e,t,i){return c("a",{href:t,title:i||e,target:"_blank",rel:"noopener",innerHTML:e})};const E="mdc-switch",J="mdc-switch__track",$="mdc-switch__thumb-underlay",U="mdc-switch__thumb",G="mdc-switch__native-control";const V={textField:["mdc-text-field","mdc-text-field--outlined"].join(" "),textfieldTextarea:["mdc-text-field--textarea","mdc-text-field--fullwidth"].join(" "),textFieldWitchIcon:"mdc-text-field--with-leading-icon",textFieldIcon:["fa","mdc-text-field__icon","mdc-text-field__icon--leading"].join(" "),input:"mdc-text-field__input",outline:"mdc-notched-outline",outlineLeading:"mdc-notched-outline__leading",outlineNotch:"mdc-notched-outline__notch",label:"mdc-floating-label",outlineTrailing:"mdc-notched-outline__trailing",helper:"mdc-text-field-helper-line",helperText:"mdc-text-field-helper-text mdc-text-field-helper-text--persistent"};function W(e){let t=V.textField;const i=[c("div",{className:V.outline},[c("div",{className:V.outlineLeading}),c("div",{className:V.outlineNotch},[c("span",{className:V.label,id:e.id,innerHTML:e.label})]),c("div",{className:V.outlineTrailing})])];if(e.textarea)t+=" "+V.textfieldTextarea,i.push(c("textarea",{className:V.input,id:e.id,rows:8,cols:80}));else{e.icon&&(t+=" "+V.textFieldWitchIcon,i.push(c("i",{className:V.textFieldIcon,innerHTML:e.icon})));const a=c("input",{className:V.input,ariaLabelledby:e.id});e.inputType&&(a.type=e.inputType),e.inputMode&&(a.inputMode=e.inputMode),e.pattern&&(a.pattern=e.pattern),"required"in e&&(a.required=e.required),i.push(a)}return c("div",{className:t},i)}(W||(W={})).helper=function(e){return c("div",{className:V.helper},[c("div",{className:V.helperText},e)])};var Z=i(13);class K extends a.Prototype{constructor(){super(...arguments),this.ctrl=null,this.items={camera:{longitude:null,latitude:null,zoom:null,bearing:null,tilt:null},size:{width:null,height:null,pixelRatio:null},display:{labels:null}},this.events={setCamera:()=>{},setLabels:()=>{}}}render(){const e=[];e.push(c("span",{className:"headline",innerHTML:"Camera"}));const t=W({id:"panel-camera-lon",label:"Longitude",inputType:"text",inputMode:"decimal",required:!0}),i=W({id:"panel-camera-lat",label:"Latitude",inputType:"text",inputMode:"decimal",required:!0}),a=W({id:"panel-camera-zoom",label:"Zoom",inputType:"text",inputMode:"decimal",required:!0}),l=W({id:"panel-camera-bearing",label:"Bearing",inputType:"text",inputMode:"decimal",required:!0}),r=W({id:"panel-camera-tilt",label:"Tilt",inputType:"text",inputMode:"decimal",required:!0}),o=h("Set");e.push(c("div",{className:"camera"},[c("div",{className:"location"},[t,i]),a,l,r,o])),e.push(c("span",{className:"headline",innerHTML:"Size"}));const d=W({id:"panel-size-width",label:"Width",inputType:"number",inputMode:"numeric",pattern:"^d+$",required:!0}),m=W({id:"panel-size-height",label:"Height",inputType:"number",inputMode:"numeric",pattern:"^d+$",required:!0}),p=W({id:"panel-size-pixelRatio",label:"Pixel Ratio",inputType:"number",inputMode:"numeric",pattern:"^d*.?d*$",required:!0});e.push(d,m,p),e.push(c("span",{className:"headline",innerHTML:"Display"}));const u=(b="input-panel-display-labels",c("div",{className:E},[c("div",{className:J}),c("div",{className:$},[c("div",{className:U}),c("input",{type:"checkbox",className:G,id:b,role:"switch"})])]));var b;e.push(c("div",{className:"switch"},[u,c("label",{for:"nput-panel-display-labels",innerHTML:"Labels"})])),e.push(c("span",{className:"headline",innerHTML:"About"})),e.push(c("span",{className:"about"},[O.link(Z.a,"https://github.com/lucka-me/mapler/blob/master/CHANGELOG.md","Changelog")])),e.push(c("span",{className:"about"},[O.link("Repository","https://github.com/lucka-me/mapler")]));const g=O("panel",{title:"Panel",contents:e,actions:[{action:"close",text:"Close"}]});this.parent.append(g),this.ctrl=new k.a(g),this.items.camera.longitude=new P.a(t),this.items.camera.longitude.value=s.a.preference.get("mapler.camera.lon"),this.items.camera.latitude=new P.a(i),this.items.camera.latitude.value=s.a.preference.get("mapler.camera.lat"),this.items.camera.zoom=new P.a(a),this.items.camera.zoom.value=s.a.preference.get("mapler.camera.zoom"),this.items.camera.bearing=new P.a(l),this.items.camera.bearing.value=s.a.preference.get("mapler.camera.bearing"),this.items.camera.tilt=new P.a(r),this.items.camera.tilt.value=s.a.preference.get("mapler.camera.tilt");new n.a(o).listen("click",(()=>this.onSetCamera()));const f=window.devicePixelRatio;this.items.size.width=new P.a(d),this.items.size.width.value=""+window.screen.width*f,this.items.size.height=new P.a(m),this.items.size.height.value=""+window.screen.height*f,this.items.size.pixelRatio=new P.a(p),this.items.size.pixelRatio.value=""+f,this.items.display.labels=new H.a(u),this.items.display.labels.checked=s.a.preference.get("mapler.display.labels"),this.items.display.labels.listen("change",(()=>{this.events.setLabels(this.items.display.labels.checked)}))}open(){this.ctrl||this.render(),this.ctrl.open()}get size(){const e={width:window.devicePixelRatio*window.screen.width,height:window.devicePixelRatio*window.screen.height,pixelRatio:window.devicePixelRatio};return this.ctrl&&(e.pixelRatio=parseFloat(this.items.size.pixelRatio.value),isNaN(e.pixelRatio)&&(e.pixelRatio=window.devicePixelRatio,this.items.size.pixelRatio.value=""+e.pixelRatio),e.width=parseInt(this.items.size.width.value),(isNaN(e.width)||e.width<1)&&(e.width=e.pixelRatio*window.screen.width,this.items.size.width.value=""+e.width),e.height=parseInt(this.items.size.height.value),(isNaN(e.height)||e.height<1)&&(e.height=e.pixelRatio*window.screen.height,this.items.size.height.value=""+e.height)),e}set camera(e){this.ctrl&&(this.items.camera.longitude.value=""+e.lon,this.items.camera.latitude.value=""+e.lat,this.items.camera.zoom.value=""+e.zoom,this.items.camera.bearing.value=""+e.bearing,this.items.camera.tilt.value=""+e.tilt)}onSetCamera(){let e=!0,t=parseFloat(this.items.camera.longitude.value);(isNaN(t)||t<-180||t>180)&&(t=s.a.preference.get("mapler.camera.lon"),this.items.camera.longitude.value=""+t,e=!1);let i=parseFloat(this.items.camera.latitude.value);(isNaN(i)||i<-90||i>90)&&(i=s.a.preference.get("mapler.camera.lat"),this.items.camera.latitude.value=""+i,e=!1);let a=parseFloat(this.items.camera.zoom.value);(isNaN(a)||a<0||a>20)&&(a=s.a.preference.get("mapler.camera.zoom"),this.items.camera.zoom.value=""+a,e=!1);let n=parseFloat(this.items.camera.bearing.value);(isNaN(n)||n<0||n>360)&&(n=s.a.preference.get("mapler.camera.bearing"),this.items.camera.bearing.value=""+n,e=!1);let l=parseFloat(this.items.camera.tilt.value);(isNaN(l)||l<0||l>60)&&(l=s.a.preference.get("mapler.camera.tilt"),this.items.camera.tilt.value=""+l,e=!1),e&&this.events.setCamera({lon:t,lat:i,zoom:a,bearing:n,tilt:l})}}const Q="mdc-fab mdc-fab--extended",X="mdc-fab__ripple",Y="fa mdc-fab__icon",ee="mdc-fab__label";class te extends a.Prototype{constructor(){super(...arguments),this.ctrl=null,this.events={click:()=>{}}}init(e){super.init(e),this.render()}render(){const e=(t="shot",i=u.Icon.camera,a="Snapshot",c("button",{className:`${Q} ${t}`},[c("div",{className:X}),c("span",{className:Y,innerHTML:i}),c("span",{className:ee,innerHTML:a})]));var t,i,a;this.parent.append(e),this.ctrl=new n.a(e),this.ctrl.listen("click",(()=>this.events.click()))}show(){this.ctrl.root.classList.remove("mdc-fab--exited")}hide(){this.ctrl.root.classList.add("mdc-fab--exited")}}var ie;!function(e){const t=new L,i=new T,a=new K,n=new te;e.init=function(){const e=document.body;t.init(e),i.defaults={camera:{lon:s.a.preference.get("mapler.camera.lon"),lat:s.a.preference.get("mapler.camera.lat"),zoom:s.a.preference.get("mapler.camera.zoom"),bearing:s.a.preference.get("mapler.camera.bearing"),tilt:s.a.preference.get("mapler.camera.tilt")},style:s.a.style.selectedStyle.uri,displayLabels:s.a.preference.get("mapler.display.labels")},i.init(e),n.init(e),a.init(e),a.events.setCamera=e=>{i.camera=e},a.events.setLabels=e=>{s.a.preference.set("mapler.display.labels",e),i.diaplayLabels=e},t.events.openPanel=()=>a.open(),t.events.selectStyle=e=>{i.style=s.a.style.select(e).uri},i.events.idle=e=>{!function(e){s.a.preference.set("mapler.camera.lon",e.lon),s.a.preference.set("mapler.camera.lat",e.lat),s.a.preference.set("mapler.camera.zoom",e.zoom),s.a.preference.set("mapler.camera.bearing",e.bearing),s.a.preference.set("mapler.camera.tilt",e.tilt)}(e),a.camera=e},n.events.click=()=>{t.disable(),n.hide(),i.shot(a.size,(()=>{t.enable(),n.show()}))}}}(ie||(ie={}))}}]);